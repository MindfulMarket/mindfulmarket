language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm i -g npm@5.7.1 # delete once 5.7.X is out of "pre-release"
  - npm ci             # faster, goes only from package-lock
before_script:
  - psql -c 'create database "boilermaker-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

# before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
# deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: mindfulmarket # see README
  api_key:
    secure: "kJdYDjKgRN8CHszRe199L5L8ePGCyvKiyYpoOfSj431KteEHExqNFnp42hUk5wppqttukBCHPwStDIImQre6C/9y+LV7wxod2q1FEaPMDZbAAHtGdPM8E6ObYWOeh3Mt0t0h66gRrzOh1xNDEjjQewwXxk+GdoO4OI8ln8l5vQ+NGDr5apXx5BNX8ZFGmYAohcexHkb07J8QtnSiR5tUEXsvh+/yL5MQW5ksK4jj3Z/at60e5/yhXCu6tOKFXj6N4Mo6WWEs/Qu9H8DjeELGIYwe7cbrwB/k9M8HChr0SIrWuzA7XOKGZF/CB2XPPqfCmZ00zrR1R2JWuWXVJxIHo/VIPBgGrR+IJrM8kZyU3Qf8b6ydLmQKfoBCIayHtUwAhkfb67GqBqPxpsGdbufuEBbNd076vOA4lzBf8Gaq6qbGTfVn0E5tQgUxKBXNjWmGunZVcMgS0gvh67oifPlC/wKb4Q7aJrMEb0OgCbqekOqQ8psqPRxTNqcE3VR2ryoc8Q3IgFbCwIvoQy4XP4yQ/eu8/xUi8zTGnDVPXG1CkzAx0vnYylrj6EFwioDYok6323RY57UsQWON7pKQSKXE/J8x2rtjj8viRjkR0/SLNJtBlE6YWwh8fGxOMUch9SVXNunCc8exDzA0SKbrjvK/b4uEXAzOVtHFLiUqw+2DHkg=" # see README
